## Info

Original Filename: Launcher.exe

File Type: PE

SHA-256: db8d4806eb82b2dab8310ab0c9efc49132e25f2c661a3421858eaeb17ec5514b

Notes: This is the default configuration for the Nim Stager built by Empire C2 meant to dropped onto a Windows client.

## Rules

#### Snort Rule

```c
alert tcp any any -> any any (msg:"Downloaded Default Win Nim Stager"; flow: to_server,established; \
	content:"Launcher.exe"; offset:5; dsize:<500; sid:133701; rev:1;)
```

#### YARA Rule
```c
import "pe"

rule WinNimEmpireStager {
        meta:
				author = "Droogy"
				description = "Detects the default windows/nim stager for Empire"
				
		strings:
                $a = "arithmetics.nim"
                $b = "@powershell -noP -sta -w 1 -enc"
        condition:
                $a and $b and
                pe.is_pe and
                (pe.imports("KERNEL32.dll") and pe.imports("msvcrt.dll")) and
                pe.calculate_checksum() == 0x8df55 and
                (filesize > 566000 and filesize < 567000)
}
```

#### Sigma Rule
```
title: Default Windows Nim Stager from Empire
id: d186b934-63d7-4c0f-8565-e2f1c46f4566
status: test
description: Detects the download of "Launcher.exe", the default name for the Nim stager from Empire C2.
author: Droogy
logsource:
	product: windows
	service: sysmon
	category: file_creation
detection:
	selection:
		EventID: 11
		Image: 'C:\WINDOWS\system32\browser_broker.exe'
		TargetFilename|Contains: '\Downloads\Launcher.exe'
	condition: selection
falsepositives: 
	- "User could've downloaded a non-malicious file"
level: High
```

