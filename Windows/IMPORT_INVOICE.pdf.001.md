**Filename**: "IMPORTS INVOICE.pdf.001"  
SHA-256: 6b5a3ecfd8d11a26fc915934959ee9f90804731452b4bacb1a8ae29ae73fe0fc  
Filesize: 480230 bytes  
Indentified Family/Strain: N/A  
Notes: 
- not actually PDF
- `file` - RAR archive data, v5
	- extract with `unrar e IMPORT*`
	- we get an executable

**Related Filename**: "IMPORTS INVOICE.pdf.exe"  
SHA-256: cb37a64fc7c2215d0f9f32ecaeb8a3e7411bd2ef5d154eb8134217bb9de0319d  
Filesize: 744960 bytes  
Indentified Family/Strain: N/A  
Reference: [ Thread RE: how .NET exe gets loaded ](https://twitter.com/0xrepnz/status/1172612565236666369?lang=en)  
Notes:
- 3 Sections; .text, .rsrc, .reloc
- extracted from "IMPORTS INVOICE.pdf.001"
- `file` - PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows

Ghidra Analysis
- under the Symbol Tree, click into entry and then check the function decompilation, it appears that this program just calls `_CorExeMain` which is typical of .NET binaries
- Ghidra shows us the OriginalFileName was "TaskCompletionSour.exe"
- we find a total of 3 PNG images with `Search -> Memory -> "IHDR"`

YARA
- generate our rule with yarGen.py
`yarGen --oe -a Droogy --score --nr -m .`
	- `--oe`: only scan executables
	- `-a`: author
	- `-m`: malware directory
	- `--nr`: non-recursive
RULE
```c
rule IMPORTS_INVOICE_pdf {

	meta:
		author = "Droogy"
		date = "2021-09-06"
		hash1 = "cb37a64fc7c2215d0f9f32ecaeb8a3e7411bd2ef5d154eb8134217bb9de0319d"
	
	strings:
		$s1 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ahSystem.Drawing.Bitmap, S" ascii /* score: '27.00'*/
		$s2 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii /* score: '27.00'*/
		$s3 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADi(i" fullword ascii /* score: '27.00'*/
		$s4 = "TaskCompletionSour.exe" fullword wide /* score: '25.00'*/
		$s6 = "  2020 - 2021" fullword wide /* score: '17.00'*/ /* hex encoded string '   !' */
		$s9 = "loginTextBox_TextChanged" fullword ascii /* score: '15.00'*/
		$s10 = "loadLogin" fullword ascii /* score: '15.00'*/
		$s11 = "passwordTextBox_TextChanged" fullword ascii /* score: '12.00'*/
		$s12 = "get_SellTickets" fullword ascii /* score: '12.00'*/
		$s13 = "get_NumberTicket" fullword ascii /* score: '12.00'*/
		$s14 = "  <assemblyIdentity version=\"1.0.0.0\" name=\"MyApplication.app\"/>" fullword ascii /* score: '11.00'*/
		$s15 = "complite" fullword ascii /* score: '11.00'*/
		$s16 = "saveFileDialog1" fullword ascii /* score: '10.00'*/
		$s17 = "Kinoteatr.SellingTicketForm.resources" fullword ascii /* score: '10.00'*/
		$s18 = "descriptRichBox" fullword ascii /* score: '10.00'*/
		$s19 = "openFileDialog1" fullword ascii /* score: '10.00'*/
		$s20 = "Kinoteatr.AuthorizationForm.resources" fullword ascii /* score: '10.00'*/
		$s21 = "PNG"
	
	condition:
		uint16(0) == 0x5a4d and 
		$s21 at 0x01ee73 and
		filesize > 744000 and
		$s4 and 
		5 of them

}
```